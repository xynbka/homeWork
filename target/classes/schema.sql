DROP TABLE IF EXISTS BOOKS;
DROP TABLE IF EXISTS AUTHOR;
DROP TABLE IF EXISTS GENRE;
DROP TABLE IF EXISTS COMMENT;
DROP TABLE IF EXISTS BOOK_AUTHOR;

CREATE TABLE BOOKS (
                    ID BIGINT auto_increment PRIMARY KEY,
                    BOOK_NAME VARCHAR(255) not null,
                    GENRE_ID BIGINT,
                    AUTHOR_ID BIGINT
);

CREATE TABLE AUTHOR (
                    ID BIGINT auto_increment PRIMARY KEY,
                    AUTHOR_NAME VARCHAR(255)
);

CREATE TABLE GENRE (
                    ID BIGINT auto_increment PRIMARY KEY,
                    GENRE_NAME VARCHAR(255) not null
);

CREATE TABLE COMMENT (
                    ID BIGINT auto_increment PRIMARY KEY,
                    COMMENT VARCHAR(255) not null ,
                    BOOK_ID BIGINT
);

create table BOOK_AUTHOR  (
                    BOOK_ID BIGINT not null,
                    AUTHOR_ID BIGINT not null
);

ALTER TABLE IF EXISTS BOOKS ADD CONSTRAINT GenreID_FK FOREIGN KEY (GENRE_ID) REFERENCES GENRE(ID);
ALTER TABLE IF EXISTS BOOKS ADD CONSTRAINT AuthorID_FK  FOREIGN KEY (AUTHOR_ID) REFERENCES AUTHOR(ID);
ALTER TABLE IF EXISTS BOOK_AUTHOR ADD CONSTRAINT PK_COMPOSITE PRIMARY KEY (BOOK_ID, AUTHOR_ID);
ALTER TABLE IF EXISTS BOOK_AUTHOR ADD CONSTRAINT FK_AUTHOR_BOOK FOREIGN KEY (BOOK_ID) references BOOKS(ID);
ALTER TABLE IF EXISTS BOOK_AUTHOR ADD CONSTRAINT FK_AUTHOR_AUTHOR FOREIGN KEY (AUTHOR_ID) references AUTHOR(ID);
alter table IF EXISTS COMMENT add constraint FK_COMMENT_BOOK foreign key (BOOK_ID) references BOOKS(ID);